/* ============================================
   SOLDBUCH BOOK — Authentic WW2 Soldbuch Style
   v4: Restored carnet feel from v1 + all v3 features
   ============================================ */

.sb-wrapper {
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 2rem 0;
  font-family: 'Courier New', monospace;
}

/* ---- COVER (closed book) ---- */
.sb-cover {
  width: 350px;
  max-width: 90%;
  min-height: 500px;
  margin: 0 auto;
  border-radius: 4px 8px 8px 4px;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 2rem;
  cursor: pointer;
  box-shadow: 3px 3px 12px rgba(0,0,0,0.4), 0 0 4px rgba(0,0,0,0.2);
  position: relative;
  transition: transform 0.3s ease;
  text-align: center;
}
.sb-cover:hover { transform: scale(1.02); }
.sb-cover::before {
  content: '';
  position: absolute;
  left: 0; top: 10px; bottom: 10px;
  width: 8px;
  background: rgba(0,0,0,0.1);
  border-radius: 2px 0 0 2px;
}

.sb-cover-border {
  border: 2px solid rgba(0,0,0,0.3);
  padding: 2rem 1.5rem;
  width: 100%;
  flex: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 1rem;
}

.sb-cover-eagle { height: 90px; width: auto; opacity: 0.8; }
.sb-cover-title {
  font-size: 1.8rem;
  font-weight: 700;
  letter-spacing: 3px;
}
.sb-cover-sub {
  font-size: 0.85rem;
  letter-spacing: 2px;
}
.sb-cover-branch {
  font-size: 1.1rem;
  font-weight: 700;
  letter-spacing: 2px;
  margin-top: 0.5rem;
}
.sb-cover-name {
  position: absolute;
  top: 12px; right: 14px;
  font-size: 0.85rem;
  font-style: italic;
  opacity: 0.7;
}
.sb-cover-hint {
  font-size: 0.7rem;
  opacity: 0.5;
  margin-top: 1rem;
  font-style: italic;
}

/* Eagle color inversion per theme */
.sb-theme-heer .sb-cover-eagle,
.sb-theme-feld .sb-cover-eagle,
.sb-theme-panzer .sb-cover-eagle { filter: brightness(0) invert(0.85); }
.sb-theme-luftwaffe .sb-cover-eagle,
.sb-theme-marine .sb-cover-eagle { filter: brightness(0) invert(0.8); }
.sb-theme-sanit .sb-cover-eagle { filter: brightness(0) invert(0.15); }

/* ---- OPEN BOOK (two-page spread) ---- */
.sb-spread {
  display: flex;
  width: 720px;
  max-width: 96%;
  min-height: 520px;
  box-shadow: 0 4px 20px rgba(0,0,0,0.3);
  border-radius: 4px;
  overflow: hidden;
  margin: 0 auto;
}

/* PAGE — 50% each, generous padding, real carnet feel */
.sb-page {
  flex: 0 0 50%;
  width: 50%;
  max-width: 50%;
  padding: 1.2rem 1rem;
  position: relative;
  font-size: 0.78rem;
  line-height: 1.5;
  min-height: 520px;
  box-sizing: border-box;
  overflow: hidden;
  display: flex;
  flex-direction: column;
}

.sb-page-l {
  border-right: 1px solid rgba(0,0,0,0.15);
  box-shadow: inset -5px 0 10px rgba(0,0,0,0.05);
}
.sb-page:not(.sb-page-l) {
  box-shadow: inset 5px 0 10px rgba(0,0,0,0.05);
}

.sb-spacer { flex: 1; min-height: 8px; }

/* PAGE NUMBER */
.sb-pagenum {
  text-align: center;
  font-size: 0.6rem;
  opacity: 0.4;
  margin-top: auto;
  padding-top: 6px;
}

/* ---- TEXT & INK STYLES ---- */
.sb-ink {
  color: #1a3a6a;
  font-weight: 600;
  font-size: 0.78rem;
}
.sb-ink-sm { font-size: 0.65rem; }

.sb-center { text-align: center; }

h4.sb-center {
  font-size: 0.9rem;
  font-weight: 700;
  letter-spacing: 1px;
  margin-bottom: 0.8rem;
}

/* ---- FIELD STYLES (label: value with dotted underline) ---- */
.sb-field {
  display: flex;
  margin-bottom: 0.3rem;
  gap: 0.3rem;
}
.sb-field-label {
  font-weight: 700;
  min-width: 130px;
  white-space: nowrap;
  font-size: 0.75rem;
}
.sb-field-value {
  border-bottom: 1px dotted rgba(0,0,0,0.3);
  flex: 1;
  padding-bottom: 1px;
  min-height: 1.2em;
}

.sb-section-title {
  font-weight: 700;
  font-size: 0.85rem;
  text-align: center;
  margin: 0.8rem 0 0.6rem;
  letter-spacing: 1px;
}

.sb-divider {
  border: none;
  border-top: 1px solid rgba(0,0,0,0.15);
  margin: 0.6rem 0;
}

/* ---- PROMOTION BOX (bordered) ---- */
.sb-box {
  border: 1.5px solid rgba(0,0,0,0.4);
  padding: 0.4rem;
  margin: 0.4rem 0;
}
.sb-promo-row {
  display: flex;
  gap: 0.4rem;
  margin-bottom: 0.2rem;
  font-size: 0.72rem;
}
.sb-promo-row .sb-promo-label {
  font-weight: 700;
  min-width: 20px;
}
.sb-promo-row .sb-promo-date,
.sb-promo-row .sb-promo-grade {
  border-bottom: 1px dotted rgba(0,0,0,0.3);
  flex: 1;
  min-height: 1.1em;
}

/* ---- TABLES ---- */
.sb-page table {
  width: 100%;
  border-collapse: collapse;
  font-size: 0.68rem;
  margin: 0.4rem 0;
}
.sb-page th,
.sb-page td {
  border: 1px solid rgba(0,0,0,0.25);
  padding: 3px 5px;
  text-align: left;
  vertical-align: top;
}
.sb-page th {
  font-weight: 700;
  font-size: 0.62rem;
  background: rgba(0,0,0,0.04);
}

/* Numbered rows */
.sb-page td:first-child {
  text-align: center;
  width: 24px;
  font-weight: 600;
}

/* ---- GEBOTE (10 Commandments) ---- */
.sb-gebote {
  font-size: 0.58rem;
  line-height: 1.35;
}
.sb-gebote h3 {
  font-size: 0.72rem;
  text-align: center;
  margin: 0 0 0.3rem;
  letter-spacing: 1px;
}
.sb-gebote h4 {
  font-size: 0.6rem;
  text-align: center;
  margin: 0 0 0.5rem;
  font-weight: 400;
}
.sb-gebote ol {
  padding-left: 1.2rem;
  margin: 0;
}
.sb-gebote ol li {
  margin-bottom: 0.2rem;
}

/* ---- SIGNATURES & STAMPS ---- */
.sb-signature-area {
  margin-top: 0.8rem;
  text-align: center;
}
.sb-signature-line {
  border-bottom: 1px solid rgba(0,0,0,0.4);
  width: 200px;
  height: 45px;
  display: inline-flex;
  align-items: flex-end;
  justify-content: center;
  margin: 0 auto;
  cursor: pointer;
}
.sb-signature-line img {
  max-height: 40px;
  max-width: 180px;
}
.sb-signature-caption {
  font-size: 0.6rem;
  opacity: 0.5;
  margin-top: 2px;
  font-style: italic;
}

.sb-stamp {
  position: absolute;
  bottom: 40px;
  right: 20px;
  opacity: 0.5;
  max-height: 70px;
}

.sb-stamp-overlay {
  position: absolute;
  opacity: 0.35;
  max-height: 80px;
  pointer-events: none;
}

/* ---- PHOTO AREA ---- */
.sb-photo-area {
  width: 100px;
  height: 130px;
  border: 2px solid rgba(0,0,0,0.3);
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
  margin: 0 auto;
}
.sb-photo-area img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

/* ---- EDITABLE CELLS ---- */
.sb-ec {
  cursor: pointer;
  min-height: 1em;
  border-bottom: 1px dotted rgba(0,0,0,0.2);
  padding: 1px 2px;
  transition: background 0.2s;
}
.sb-ec:hover {
  background: rgba(26, 58, 106, 0.08);
}
.sb-ec input {
  width: 100%;
  border: none;
  border-bottom: 1px solid #1a3a6a;
  background: rgba(26, 58, 106, 0.06);
  font-family: inherit;
  font-size: inherit;
  color: #1a3a6a;
  padding: 1px 2px;
  outline: none;
}

/* ---- PAGE 1 SPECIFIC ---- */
.sb-sm { font-size: 0.65rem; }
.sb-xs { font-size: 0.55rem; }
.sb-u { text-decoration: underline; }
.sb-label { opacity: 0.5; font-style: italic; font-size: 0.6rem; }
.sb-line { border-bottom: 1px dotted rgba(0,0,0,0.3); min-height: 1.1em; display: inline-block; }
.sb-lined { border-bottom: 1px dotted rgba(0,0,0,0.3); }

.sb-page1-field {
  display: flex;
  gap: 0.3rem;
  margin-bottom: 0.3rem;
  align-items: baseline;
}
.sb-page1-field .sb-lbl-cell { font-weight: 700; min-width: 120px; font-size: 0.72rem; }
.sb-page1-field .sb-val-cell { flex: 1; }

.sb-page1-grade { font-size: 0.9rem; font-weight: 600; margin: 0.3rem 0; }
.sb-page1-name { font-size: 1rem; font-weight: 700; margin: 0.6rem 0 0.3rem; }

.sb-grade-box {
  border: 1.5px solid rgba(0,0,0,0.35);
  padding: 0.3rem 0.4rem;
  margin: 0.4rem 0;
}
.sb-grade-box-labels {
  display: flex;
  justify-content: space-around;
  font-size: 0.55rem;
  opacity: 0.5;
  font-style: italic;
  margin-bottom: 0.2rem;
}
.sb-lbl-cell { font-weight: 700; font-size: 0.68rem; }
.sb-val-cell { font-size: 0.72rem; }

/* ---- PHOTO (identity) ---- */
.sb-photo {
  width: 80px;
  height: 100px;
  border: 1.5px solid rgba(0,0,0,0.3);
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
  margin: 0.5rem auto;
}
.sb-photo img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}
.sb-photo-empty {
  font-size: 0.55rem;
  opacity: 0.3;
  font-style: italic;
}

/* ---- SIGNATURES ---- */
.sb-sig-area {
  text-align: center;
  margin-top: 0.4rem;
}
.sb-sig-box {
  border-bottom: 1px solid rgba(0,0,0,0.35);
  height: 35px;
  display: inline-flex;
  align-items: flex-end;
  justify-content: center;
  min-width: 150px;
}
.sb-sig-box.sb-sig-empty { opacity: 0.3; }
.sb-sig-img { max-height: 32px; max-width: 140px; }
.sb-sig-clickable {
  cursor: pointer;
  font-size: 0.6rem;
  color: var(--military-green, #4b5320);
  opacity: 0.7;
}
.sb-sig-clickable:hover { opacity: 1; }

/* ---- STAMP ---- */
.sb-stamp-row {
  display: flex;
  justify-content: flex-end;
  margin-top: 0.4rem;
}
.sb-stamp-img {
  max-height: 55px;
  max-width: 55px;
  opacity: 0.6;
}
.sb-stamp-clickable {
  cursor: pointer;
  font-size: 0.65rem;
  opacity: 0.4;
  border: 1px dashed rgba(0,0,0,0.2);
  padding: 4px 8px;
  border-radius: 3px;
}
.sb-stamp-clickable:hover { opacity: 0.7; }
.sb-stamp-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(70px, 1fr));
  gap: 8px;
  margin: 0.5rem 0;
}
.sb-stamp-option {
  cursor: pointer;
  text-align: center;
  border: 1px solid rgba(0,0,0,0.15);
  border-radius: 4px;
  padding: 4px;
  transition: background 0.2s;
}
.sb-stamp-option:hover { background: rgba(0,0,0,0.06); }
.sb-stamp-option img { max-height: 50px; max-width: 100%; }

/* ---- ATTESTATION STAMP (small in table) ---- */
.sb-att-stamp { max-height: 18px; max-width: 40px; opacity: 0.7; vertical-align: middle; }
.sb-att-wrap { display: flex; gap: 3px; align-items: center; }

/* ---- TABLES ---- */
.sb-t {
  width: 100%;
  border-collapse: collapse;
  font-size: 0.65rem;
  margin: 0.3rem 0;
}
.sb-t th, .sb-t td {
  border: 1px solid rgba(0,0,0,0.22);
  padding: 2px 4px;
  text-align: left;
  vertical-align: top;
}
.sb-t th {
  font-weight: 700;
  font-size: 0.58rem;
  background: rgba(0,0,0,0.04);
}
.sb-t-grid { table-layout: fixed; }
.sb-t-inner { border: none; }
.sb-t-inner td, .sb-t-inner th { border: 1px solid rgba(0,0,0,0.15); }
.sb-teeth td { font-size: 0.55rem; }

/* ---- RULES / GEBOTE ---- */
.sb-rules {
  font-size: 0.55rem;
  line-height: 1.35;
}
.sb-rules h3 { font-size: 0.68rem; text-align: center; margin-bottom: 0.3rem; }
.sb-rules h4 { font-size: 0.58rem; text-align: center; margin-bottom: 0.5rem; font-weight: 400; }
.sb-rules ol { padding-left: 1.2rem; margin: 0; }
.sb-rules ol li { margin-bottom: 0.15rem; }

/* ---- MEDICAL (vaccinations etc.) ---- */
.sb-impf { font-size: 0.6rem; }

/* ---- PERMISSIONS (Urlaub) ---- */
.sb-urlaub { font-size: 0.6rem; }

/* ---- MODAL (stamp picker, habillement popup) ---- */
.sb-modal-overlay {
  position: fixed;
  top: 0; left: 0; right: 0; bottom: 0;
  background: rgba(0,0,0,0.5);
  z-index: 1000;
  display: flex;
  align-items: center;
  justify-content: center;
}
.sb-modal {
  background: #f5f0e1;
  border: 2px solid rgba(0,0,0,0.3);
  border-radius: 6px;
  padding: 1.5rem;
  max-width: 400px;
  width: 90%;
  max-height: 80vh;
  overflow-y: auto;
  font-family: 'Courier New', monospace;
}

/* ---- BACK COVER ---- */
.sb-back-cover {
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 0.7rem;
  opacity: 0.4;
  font-style: italic;
  min-height: 100%;
}

/* ---- PAGE DARK (gebote, etc.) ---- */
/* Handled by theme-specific .sb-page:first-child rules above */
.sb-page-dark { /* fallback */ }
.sb-page-r { /* right page - default */ }

/* ---- NAV INFO ---- */
.sb-nav-info {
  text-align: center;
  font-size: 0.7rem;
  opacity: 0.5;
  margin-top: 0.3rem;
}

/* ---- NAVIGATION ---- */
.sb-nav {
  display: flex;
  justify-content: center;
  gap: 1rem;
  margin-top: 1rem;
}
.sb-nav button {
  font-family: 'Courier New', monospace;
  padding: 0.5rem 1.5rem;
  cursor: pointer;
  background: rgba(0,0,0,0.05);
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  font-size: 0.85rem;
  transition: background 0.2s;
}
.sb-nav button:hover { background: rgba(0,0,0,0.12); }
.sb-nav button:disabled { opacity: 0.3; cursor: default; }

/* ---- ACTIONS (equipment presets, etc.) ---- */
.sb-actions {
  display: flex;
  gap: 0.5rem;
  justify-content: center;
  flex-wrap: wrap;
  margin: 0.8rem 0;
}
.sb-actions button {
  font-family: 'Courier New', monospace;
  font-size: 0.7rem;
  padding: 0.3rem 0.8rem;
  border: 1px solid rgba(0,0,0,0.2);
  background: rgba(0,0,0,0.04);
  border-radius: 3px;
  cursor: pointer;
  transition: background 0.2s;
}
.sb-actions button:hover { background: rgba(0,0,0,0.1); }

/* ---- ATTESTATION BARRED ---- */
.sb-barred td {
  text-decoration: line-through;
  opacity: 0.5;
}
.sb-barred-motif {
  color: #8b0000;
  font-size: 0.55rem;
  font-style: italic;
}

/* ============================================
   REGIMENT THEMES
   Based on real Wehrmacht Soldbuch branch colors
   ============================================ */

/* Heer (default) — brown-red like authentic Soldbuch */
.sb-theme-heer .sb-cover {
  background: linear-gradient(135deg, #7a4a3a, #5e3828);
  color: #e8d8c0;
}
.sb-theme-heer .sb-page {
  background: #f2e8d0;
  color: #2c2416;
}

/* Luftwaffe / Fallschirmjaeger — blue-grey */
.sb-theme-luftwaffe .sb-cover {
  background: linear-gradient(135deg, #536d7a, #3f5868);
  color: #d8e0e6;
}
.sb-theme-luftwaffe .sb-page {
  background: #f2e8d0;
  color: #2c2416;
}

/* Feldgendarmerie — feldgrau */
.sb-theme-feld .sb-cover {
  background: linear-gradient(135deg, #4a5540, #3a4530);
  color: #d8d4c0;
}
.sb-theme-feld .sb-page {
  background: #f2e8d0;
  color: #2c2416;
}

/* Panzer — dark grey/black */
.sb-theme-panzer .sb-cover {
  background: linear-gradient(135deg, #3a3a3a, #2a2a2a);
  color: #d8d0b8;
}
.sb-theme-panzer .sb-page {
  background: #f2e8d0;
  color: #2c2416;
}

/* Sanitäts — white/cream with red cross accent */
.sb-theme-sanit .sb-cover {
  background: linear-gradient(135deg, #e0d8c0, #d0c8b0);
  color: #2c2416;
}
.sb-theme-sanit .sb-page {
  background: #f2e8d0;
  color: #2c2416;
}

/* Marine — navy blue */
.sb-theme-marine .sb-cover {
  background: linear-gradient(135deg, #2a3a5a, #1e2e4a);
  color: #d0d8e8;
}
.sb-theme-marine .sb-page {
  background: #f2e8d0;
  color: #2c2416;
}

/* Gebote page (left of first spread) — darker tint per theme */
.sb-theme-heer .sb-page:first-child { background: #ddd4be; }
.sb-theme-luftwaffe .sb-page:first-child { background: #6b8a9a; color: #1a2a33; }
.sb-theme-feld .sb-page:first-child { background: #5a6a4e; color: #e8e0c8; }
.sb-theme-panzer .sb-page:first-child { background: #4a4a4a; color: #d8d0b8; }
.sb-theme-sanit .sb-page:first-child { background: #d8d0b8; }
.sb-theme-marine .sb-page:first-child { background: #3a4a6a; color: #d0d8e8; }

/* ---- RESPONSIVE ---- */
@media (max-width: 768px) {
  .sb-spread {
    width: 100%;
    flex-direction: column;
    min-height: auto;
  }
  .sb-page {
    flex: 0 0 auto;
    width: 100%;
    max-width: 100%;
    min-height: 420px;
    padding: 1rem;
    font-size: 0.72rem;
  }
  .sb-page-l {
    border-right: none;
    border-bottom: 1px solid rgba(0,0,0,0.15);
  }
  .sb-cover { width: 90%; min-height: 400px; }
  .sb-field-label { min-width: 100px; font-size: 0.68rem; }
  .sb-gebote { font-size: 0.5rem; }
  .sb-actions { display: none; } /* Hide editor controls on mobile */
  .sb-ec { cursor: default; }
  .sb-ec:hover { background: none; }
}
