/* ============================================
   SOLDBUCH BOOK v4.2 — Authentic WW2 Carnet
   Restored v1 carnet feel + all v3.1 features
   ============================================ */

/* ---- WRAPPER ---- */
.sb-wrapper {
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 2rem 0;
  font-family: 'Courier New', monospace;
}

/* ============================================
   COVER (closed book)
   ============================================ */
.sb-cover {
  width: 350px;
  max-width: 90%;
  min-height: 500px;
  margin: 0 auto;
  border-radius: 4px 8px 8px 4px;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 2rem;
  cursor: pointer;
  box-shadow: 3px 3px 12px rgba(0,0,0,0.4), 0 0 4px rgba(0,0,0,0.2);
  position: relative;
  transition: transform 0.3s ease;
  text-align: center;
}
.sb-cover:hover { transform: scale(1.02); }
.sb-cover::before {
  content: '';
  position: absolute;
  left: 0; top: 10px; bottom: 10px;
  width: 8px;
  background: rgba(0,0,0,0.1);
  border-radius: 2px 0 0 2px;
}
.sb-cover-border {
  border: 2px solid rgba(0,0,0,0.3);
  padding: 2rem 1.5rem;
  width: 100%;
  flex: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 1rem;
}
.sb-cover-eagle { height: 90px; width: auto; opacity: 0.8; }
.sb-cover-title { font-size: 1.8rem; font-weight: 700; letter-spacing: 3px; }
.sb-cover-sub { font-size: 0.85rem; letter-spacing: 2px; }
.sb-cover-branch { font-size: 1.1rem; font-weight: 700; letter-spacing: 2px; margin-top: 0.5rem; }
.sb-cover-name { position: absolute; top: 12px; right: 14px; font-size: 0.85rem; font-style: italic; opacity: 0.7; }
.sb-cover-hint { font-size: 0.7rem; opacity: 0.5; margin-top: 1rem; font-style: italic; }

/* Eagle color per theme */
.sb-theme-heer .sb-cover-eagle, .sb-theme-feld .sb-cover-eagle, .sb-theme-panzer .sb-cover-eagle { filter: brightness(0) invert(0.85); }
.sb-theme-luftwaffe .sb-cover-eagle, .sb-theme-marine .sb-cover-eagle { filter: brightness(0) invert(0.8); }
.sb-theme-sanit .sb-cover-eagle { filter: brightness(0) invert(0.15); }

/* ============================================
   SPREAD (open book — two pages side by side)
   ============================================ */
.sb-spread {
  display: flex;
  width: 720px;
  max-width: 96%;
  box-shadow: 0 4px 20px rgba(0,0,0,0.3);
  border-radius: 4px;
  overflow: hidden;
  margin: 0 auto;
}

/* ---- PAGE ---- */
.sb-page {
  flex: 0 0 50%;
  width: 50%;
  max-width: 50%;
  padding: 1rem 0.8rem;
  position: relative;
  font-size: 0.72rem;
  line-height: 1.45;
  min-height: 520px;
  box-sizing: border-box;
  overflow: hidden;
  display: flex;
  flex-direction: column;
}
/* Force ALL children to respect page width */
.sb-page > *, .sb-page table, .sb-page div, .sb-page p {
  max-width: 100%;
  box-sizing: border-box;
}
.sb-page-l {
  border-right: 1px solid rgba(0,0,0,0.15);
  box-shadow: inset -5px 0 10px rgba(0,0,0,0.05);
}
.sb-page-r {
  box-shadow: inset 5px 0 10px rgba(0,0,0,0.05);
}
.sb-spacer { flex: 1; min-height: 8px; }
.sb-pagenum { text-align: center; font-size: 0.55rem; opacity: 0.35; margin-top: auto; padding-top: 6px; }

/* ============================================
   TEXT HELPERS
   ============================================ */
.sb-ink { color: #1a3a6a; font-weight: 600; }
.sb-ink-sm { font-size: 0.62rem; }
.sb-center { text-align: center; }
.sb-sm { font-size: 0.62rem; }
.sb-xs { font-size: 0.52rem; }
.sb-u { text-decoration: underline; }
.sb-label { opacity: 0.5; font-style: italic; font-size: 0.58rem; margin: 0.3rem 0 0.15rem; }

/* Page headings inside pages */
.sb-page h3 { font-size: 0.85rem; font-weight: 700; margin: 0 0 0.4rem; }
.sb-page h4, h4.sb-center { font-size: 0.78rem; font-weight: 700; letter-spacing: 0.5px; margin: 0.4rem 0 0.3rem; }

/* ============================================
   PAGE 1 — Identity (v1 field style)
   ============================================ */
.sb-field {
  display: flex;
  margin-bottom: 0.3rem;
  gap: 0.3rem;
}
.sb-field-label {
  font-weight: 700;
  min-width: 130px;
  white-space: nowrap;
  font-size: 0.72rem;
}
.sb-field-value {
  border-bottom: 1px dotted rgba(0,0,0,0.3);
  flex: 1;
  padding-bottom: 1px;
  min-height: 1.2em;
}

.sb-section-title {
  font-weight: 700;
  font-size: 0.82rem;
  text-align: center;
  margin: 0.8rem 0 0.5rem;
  letter-spacing: 1px;
}

.sb-divider {
  border: none;
  border-top: 1px solid rgba(0,0,0,0.15);
  margin: 0.6rem 0;
}

/* Promotion box */
.sb-box {
  border: 1.5px solid rgba(0,0,0,0.4);
  padding: 0.4rem;
  margin: 0.4rem 0;
}
.sb-promo-row {
  display: flex;
  gap: 0.4rem;
  margin-bottom: 0.2rem;
  font-size: 0.72rem;
}
.sb-promo-row .sb-promo-label { font-weight: 700; min-width: 20px; }
.sb-promo-row .sb-promo-date,
.sb-promo-row .sb-promo-grade {
  border-bottom: 1px dotted rgba(0,0,0,0.3);
  flex: 1;
  min-height: 1.1em;
}

.sb-lbl-cell { font-weight: 700; font-size: 0.62rem; white-space: nowrap; }
.sb-val-cell { font-size: 0.65rem; }

/* ============================================
   TABLES — THE KEY FIX
   table-layout: fixed prevents overflow!
   ============================================ */
.sb-t {
  width: 100%;
  border-collapse: collapse;
  font-size: 0.6rem;
  margin: 0.2rem 0;
  table-layout: fixed;
  word-wrap: break-word;
  overflow-wrap: break-word;
}
.sb-t th, .sb-t td {
  border: 1px solid rgba(0,0,0,0.2);
  padding: 2px 3px;
  text-align: left;
  vertical-align: top;
  overflow: hidden;
  text-overflow: ellipsis;
}
.sb-t th {
  font-weight: 700;
  font-size: 0.52rem;
  background: rgba(0,0,0,0.04);
  white-space: nowrap;
}
.sb-t-grid { /* grid tables with equal columns */ }
.sb-t-inner { border: none; }
.sb-t-inner td, .sb-t-inner th { border-bottom: 1px dotted rgba(0,0,0,0.25); border-left: none; border-right: none; border-top: none; }
.sb-teeth td { font-size: 0.55rem; text-align: center; letter-spacing: 2px; font-weight: 600; }

/* ============================================
   PHOTO
   ============================================ */
.sb-photo {
  width: 75px;
  height: 95px;
  border: 2px solid rgba(0,0,0,0.3);
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
  margin: 0.3rem auto;
  background: rgba(0,0,0,0.02);
}
.sb-photo img { width: 100%; height: 100%; object-fit: cover; }
.sb-photo-empty { font-size: 0.5rem; opacity: 0.25; font-style: italic; }

/* ============================================
   SIGNATURES
   ============================================ */
.sb-sig-area { text-align: center; margin-top: 0.3rem; }
.sb-sig-box {
  border-bottom: 1px solid rgba(0,0,0,0.35);
  height: 30px;
  display: inline-flex;
  align-items: flex-end;
  justify-content: center;
  min-width: 120px;
}
.sb-sig-box.sb-sig-empty { opacity: 0.3; }
.sb-sig-img { max-height: 28px; max-width: 120px; }
.sb-sig-clickable { cursor: pointer; color: #4b5320; opacity: 0.6; font-size: 0.55rem; }
.sb-sig-clickable:hover { opacity: 1; }

/* ============================================
   STAMPS
   ============================================ */
.sb-stamp-row { display: flex; justify-content: space-between; align-items: flex-end; gap: 0.5rem; margin-top: 0.3rem; }
.sb-stamp-img { max-height: 50px; max-width: 50px; opacity: 0.55; }
.sb-stamp-clickable { cursor: pointer; font-size: 0.6rem; opacity: 0.35; border: 1px dashed rgba(0,0,0,0.2); padding: 3px 6px; border-radius: 3px; }
.sb-stamp-clickable:hover { opacity: 0.6; }
.sb-stamp-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(65px, 1fr)); gap: 6px; margin: 0.4rem 0; }
.sb-stamp-option { cursor: pointer; text-align: center; border: 1px solid rgba(0,0,0,0.12); border-radius: 3px; padding: 3px; font-size: 0.5rem; }
.sb-stamp-option:hover { background: rgba(0,0,0,0.06); }
.sb-stamp-option img { max-height: 45px; max-width: 100%; }
.sb-stamp-overlay { position: absolute; opacity: 0.3; max-height: 60px; pointer-events: none; }
.sb-att-stamp { max-height: 16px; max-width: 35px; opacity: 0.65; vertical-align: middle; }
.sb-att-wrap { flex: 1; overflow: hidden; }

/* ============================================
   EDITABLE CELLS
   ============================================ */
.sb-ec {
  cursor: pointer;
  min-height: 1em;
  padding: 1px 2px;
  transition: background 0.15s;
}
.sb-ec:hover { background: rgba(26, 58, 106, 0.06); }
.sb-ec input {
  width: 100%;
  max-width: 100%;
  border: none;
  border-bottom: 1px solid #1a3a6a;
  background: rgba(26, 58, 106, 0.04);
  font-family: inherit;
  font-size: inherit;
  color: #1a3a6a;
  padding: 1px 2px;
  outline: none;
  box-sizing: border-box;
}
/* Constrain ALL inputs/selects inside pages */
.sb-page input, .sb-page select, .sb-page textarea {
  max-width: 100%;
  box-sizing: border-box;
  font-size: 0.55rem;
}

/* ============================================
   LINED PAGES (notes, remarks)
   ============================================ */
.sb-lined { display: flex; flex-direction: column; }
.sb-line {
  border-bottom: 1px solid rgba(0,0,0,0.12);
  min-height: 1.3em;
  width: 100%;
}

/* ============================================
   RULES / 10 GEBOTE
   ============================================ */
/* Rules list (used inside sb-gebote) */
.sb-rules, ol.sb-rules {
  font-size: 0.5rem;
  line-height: 1.25;
  padding-left: 1rem;
  margin: 0;
}
.sb-rules li { margin-bottom: 0.1rem; }

/* Gebote container — fills the page */
.sb-gebote {
  flex: 1;
  font-size: 0.58rem;
  line-height: 1.35;
  display: flex;
  flex-direction: column;
}
.sb-gebote h3 {
  font-size: 0.75rem;
  text-align: center;
  margin: 0 0 0.3rem;
  letter-spacing: 1px;
}
.sb-gebote h4 {
  font-size: 0.62rem;
  text-align: center;
  margin: 0 0 0.5rem;
  font-weight: 400;
}
.sb-gebote ol {
  padding-left: 1.2rem;
  margin: 0;
  flex: 1;
}
.sb-gebote ol li { margin-bottom: 0.2rem; }

/* ============================================
   SPECIFIC SECTIONS
   ============================================ */
.sb-impf { margin-bottom: 0.2rem; }
.sb-urlaub { margin-bottom: 0.3rem; }

/* ============================================
   NAVIGATION
   ============================================ */
.sb-nav {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 0.8rem;
  margin-top: 1rem;
}
.sb-nav button {
  font-family: 'Courier New', monospace;
  padding: 0.4rem 1.2rem;
  cursor: pointer;
  background: rgba(0,0,0,0.05);
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  font-size: 0.8rem;
  transition: background 0.2s;
}
.sb-nav button:hover { background: rgba(0,0,0,0.12); }
.sb-nav button:disabled { opacity: 0.3; cursor: default; }
.sb-nav-info { font-size: 0.65rem; opacity: 0.5; min-width: 100px; text-align: center; }

/* ============================================
   MODAL (stamp picker, habillement popup)
   ============================================ */
.sb-modal-overlay {
  position: fixed;
  top: 0; left: 0; right: 0; bottom: 0;
  background: rgba(0,0,0,0.5);
  z-index: 1000;
  display: flex;
  align-items: center;
  justify-content: center;
}
.sb-modal {
  background: #f5f0e1;
  border: 2px solid rgba(0,0,0,0.3);
  border-radius: 6px;
  padding: 1.2rem;
  max-width: 380px;
  width: 90%;
  max-height: 80vh;
  overflow-y: auto;
  font-family: 'Courier New', monospace;
  font-size: 0.75rem;
}

/* ============================================
   BACK COVER
   ============================================ */
.sb-back-cover {
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 0.62rem;
  opacity: 0.35;
  font-style: italic;
  min-height: 100%;
  text-align: center;
  padding: 2rem;
}
.sb-page-dark { /* handled by theme rules below */ }

/* ============================================
   REGIMENT THEMES
   Based on real Wehrmacht Soldbuch conventions
   ============================================ */

/* Heer (default) — brown-red authentic */
.sb-theme-heer .sb-cover { background: linear-gradient(135deg, #7a4a3a, #5e3828); color: #e8d8c0; }
.sb-theme-heer .sb-page { background: #f2e8d0; color: #2c2416; }
.sb-theme-heer .sb-page-dark { background: #ddd4be; }

/* Luftwaffe / Fallschirmjaeger — blue-grey */
.sb-theme-luftwaffe .sb-cover { background: linear-gradient(135deg, #536d7a, #3f5868); color: #d8e0e6; }
.sb-theme-luftwaffe .sb-page { background: #f2e8d0; color: #2c2416; }
.sb-theme-luftwaffe .sb-page-dark { background: #6b8a9a; color: #1a2a33; }

/* Feldgendarmerie — feldgrau */
.sb-theme-feld .sb-cover { background: linear-gradient(135deg, #4a5540, #3a4530); color: #d8d4c0; }
.sb-theme-feld .sb-page { background: #f2e8d0; color: #2c2416; }
.sb-theme-feld .sb-page-dark { background: #5a6a4e; color: #e8e0c8; }

/* Panzer — dark grey/black */
.sb-theme-panzer .sb-cover { background: linear-gradient(135deg, #3a3a3a, #2a2a2a); color: #d8d0b8; }
.sb-theme-panzer .sb-page { background: #f2e8d0; color: #2c2416; }
.sb-theme-panzer .sb-page-dark { background: #4a4a4a; color: #d8d0b8; }

/* Sanitäts — white/cream */
.sb-theme-sanit .sb-cover { background: linear-gradient(135deg, #e0d8c0, #d0c8b0); color: #2c2416; }
.sb-theme-sanit .sb-page { background: #f2e8d0; color: #2c2416; }
.sb-theme-sanit .sb-page-dark { background: #d8d0b8; }

/* Marine — navy blue */
.sb-theme-marine .sb-cover { background: linear-gradient(135deg, #2a3a5a, #1e2e4a); color: #d0d8e8; }
.sb-theme-marine .sb-page { background: #f2e8d0; color: #2c2416; }
.sb-theme-marine .sb-page-dark { background: #3a4a6a; color: #d0d8e8; }

/* ============================================
   RESPONSIVE
   ============================================ */
@media (max-width: 768px) {
  .sb-spread { width: 100%; flex-direction: column; }
  .sb-page { flex: 0 0 auto; width: 100%; max-width: 100%; min-height: 400px; padding: 0.8rem; font-size: 0.68rem; }
  .sb-page-l { border-right: none; border-bottom: 1px solid rgba(0,0,0,0.15); box-shadow: none; }
  .sb-page-r { box-shadow: none; }
  .sb-cover { width: 90%; min-height: 400px; }
  .sb-t { font-size: 0.55rem; }
  .sb-t th { font-size: 0.48rem; }
  .sb-ec { cursor: default; }
  .sb-ec:hover { background: none; }
  .sb-rules { font-size: 0.48rem; }
}
